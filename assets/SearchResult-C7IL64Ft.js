import{u as O,f as Z,h as ee,i as U,j as le,k as ae,t as se,l as te,m as j,p as q,q as he,s as M,v as a,x as _,y as F,R as I,z as ne,A as oe,B as re,C as ie,D as ue,E as ce,F as me,G as ve,H as de,I as pe,J as we,K as ye,L as ze,M as D}from"./app-B6vbZcSP.js";const fe=["/","/zh-hans/assets.html","/zh-hans/de.html","/zh-hans/","/zh-hans/md.html","/zh-hans/sitehelp.html","/zh-hans/up.html","/zh-hant/","/zh-hans/account/apkxa.html","/zh-hans/account/google.html","/zh-hans/account/","/zh-hans/account/ios.html","/zh-hans/markdown/","/zh-hans/mw/game-info.html","/zh-hans/mw/","/zh-hans/mw/mw-press.html","/zh-hans/mwt/","/zh-hans/markdown/other/","/zh-hans/mw/collection/cn.html","/zh-hans/mw/collection/ct.html","/zh-hans/mw/collection/ctto.html","/zh-hans/mw/collection/egg.html","/zh-hans/mw/collection/events-less.html","/zh-hans/mw/collection/","/zh-hans/mw/collection/lj.html","/zh-hans/mw/collection/market.html","/zh-hans/mw/collection/musk.html","/zh-hans/mw/collection/mw68.html","/zh-hans/mw/collection/mw70.html","/zh-hans/mw/collection/news.html","/zh-hans/mw/collection/pan.html","/zh-hans/mw/column/bomber.html","/zh-hans/mw/column/fighter.html","/zh-hans/mw/column/helicopter.html","/zh-hans/mw/column/","/zh-hans/mw/column/uav.html","/zh-hans/mw/download/app.html","/zh-hans/mw/download/","/zh-hans/mw/download/mod.html","/zh-hans/mw/download/pc.html","/zh-hans/mw/download/sys.html","/zh-hans/mw/download/zg.html","/zh-hans/mw/official/bp.html","/zh-hans/mw/official/bs.html","/zh-hans/mw/official/","/zh-hans/mw/official/jd.html","/zh-hans/mw/official/lt.html","/zh-hans/mw/official/qt.html","/zh-hans/mw/official/sc.html","/zh-hans/mw/official/sd.html","/zh-hans/mw/official/wf.html","/zh-hans/mw/official/yj.html","/zh-hans/mw/official/zb.html","/zh-hans/mw/official/zd.html","/zh-hans/mw/official/zh.html","/zh-hans/mw/official/zy.html","/zh-hans/mw/skills/cyct.html","/zh-hans/mw/skills/game.html","/zh-hans/mw/skills/","/zh-hans/mw/skills/mom.html","/zh-hans/mw/skills/mw-rules.html","/zh-hans/mw/skills/stan-bilibili.html","/zh-hans/mw/skills/x51.html","/zh-hans/markdown/other/emoji/nature.html","/zh-hans/markdown/other/emoji/object.html","/zh-hans/markdown/other/emoji/people.html","/zh-hans/markdown/other/emoji/place.html","/zh-hans/markdown/other/emoji/symbol.html","/404.html","/zh-hans/markdown/other/emoji/"],ke="SEARCH_PRO_QUERY_HISTORY",v=O(ke,[]),ge=()=>{const{queryHistoryCount:s}=D,t=s>0;return{enabled:t,queryHistory:v,addQueryHistory:h=>{t&&(v.value.length<s?v.value=Array.from(new Set([h,...v.value])):v.value=Array.from(new Set([h,...v.value.slice(0,s-1)])))},removeQueryHistory:h=>{v.value=[...v.value.slice(0,h),...v.value.slice(h+1)]}}},A=s=>fe[s.id]+("anchor"in s?`#${s.anchor}`:""),He="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:C}=D,d=O(He,[]),Re=()=>{const s=C>0;return{enabled:s,resultHistory:d,addResultHistory:t=>{if(s){const h={link:A(t),display:t.display};"header"in t&&(h.header=t.header),d.value.length<C?d.value=[h,...d.value]:d.value=[h,...d.value.slice(0,C-1)]}},removeResultHistory:t=>{d.value=[...d.value.slice(0,t),...d.value.slice(t+1)]}}},Qe=s=>{const t=ue(),h=U(),{search:H,terminate:c}=ce(),w=j(!1),y=me([]);return ve(()=>{const p=()=>{y.value=[],w.value=!1},R=ze(z=>{w.value=!0,z?H({type:"search",query:z,locale:h.value,options:t}).then(m=>{y.value=m,w.value=!1}).catch(m=>{console.error(m),p()}):p()},D.searchDelay);M([s,h],()=>R(s.value),{immediate:!0}),de(()=>{c()})}),{searching:w,results:y}};var be=Z({name:"SearchResult",props:{query:{type:String,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(s,{emit:t}){const h=ee(),H=U(),c=le(ae),{enabled:w,addQueryHistory:y,queryHistory:p,removeQueryHistory:R}=ge(),{enabled:z,resultHistory:m,addResultHistory:L,removeResultHistory:B}=Re(),E=w||z,Q=se(s,"query"),{results:f,searching:Y}=Qe(Q),n=te({isQuery:!0,index:0}),i=j(0),u=j(0),T=q(()=>E&&(p.value.length>0||m.value.length>0)),x=q(()=>f.value.length>0),b=q(()=>f.value[i.value]||null),G=()=>{const{isQuery:e,index:l}=n;l===0?(n.isQuery=!e,n.index=e?m.value.length-1:p.value.length-1):n.index=l-1},J=()=>{const{isQuery:e,index:l}=n;l===(e?p.value.length-1:m.value.length-1)?(n.isQuery=!e,n.index=0):n.index=l+1},K=()=>{i.value=i.value>0?i.value-1:f.value.length-1,u.value=b.value.contents.length-1},V=()=>{i.value=i.value<f.value.length-1?i.value+1:0,u.value=0},$=()=>{u.value<b.value.contents.length-1?u.value+=1:V()},N=()=>{u.value>0?u.value-=1:K()},S=e=>e.map(l=>pe(l)?l:a(l[0],l[1])),W=e=>{if(e.type==="customField"){const l=we[e.index]||"$content",[o,g=""]=ye(l)?l[H.value].split("$content"):l.split("$content");return e.display.map(r=>a("div",S([o,...r,g])))}return e.display.map(l=>a("div",S(l)))},k=()=>{i.value=0,u.value=0,t("updateQuery",""),t("close")};return he("keydown",e=>{if(s.isFocusing){if(x.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")$();else if(e.key==="Enter"){const l=b.value.contents[u.value];y(s.query),L(l),h.push(A(l)),k()}}else if(z){if(e.key==="ArrowUp")G();else if(e.key==="ArrowDown")J();else if(e.key==="Enter"){const{index:l}=n;n.isQuery?(t("updateQuery",p.value[l]),e.preventDefault()):(h.push(m.value[l].link),k())}}}}),M([i,u],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>a("div",{class:["search-pro-result-wrapper",{empty:Q.value?!x.value:!T.value}],id:"search-pro-results"},Q.value===""?E?T.value?[w?a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},c.value.queryHistory),p.value.map((e,l)=>a("div",{class:["search-pro-result-item",{active:n.isQuery&&n.index===l}],onClick:()=>{t("updateQuery",e)}},[a(_,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},e),a("button",{class:"search-pro-remove-icon",innerHTML:F,onClick:o=>{o.preventDefault(),o.stopPropagation(),R(l)}})]))])):null,z?a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},c.value.resultHistory),m.value.map((e,l)=>a(I,{to:e.link,class:["search-pro-result-item",{active:!n.isQuery&&n.index===l}],onClick:()=>{k()}},()=>[a(_,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[e.header?a("div",{class:"content-header"},e.header):null,a("div",e.display.map(o=>S(o)).flat())]),a("button",{class:"search-pro-remove-icon",innerHTML:F,onClick:o=>{o.preventDefault(),o.stopPropagation(),B(l)}})]))])):null]:c.value.emptyHistory:c.value.emptyResult:Y.value?a(ne,{hint:c.value.searching}):x.value?a("ul",{class:"search-pro-result-list"},f.value.map(({title:e,contents:l},o)=>{const g=i.value===o;return a("li",{class:["search-pro-result-list-item",{active:g}]},[a("div",{class:"search-pro-result-title"},e||c.value.defaultTitle),l.map((r,X)=>{const P=g&&u.value===X;return a(I,{to:A(r),class:["search-pro-result-item",{active:P,"aria-selected":P}],onClick:()=>{y(s.query),L(r),k()}},()=>[r.type==="text"?null:a(r.type==="title"?oe:r.type==="heading"?re:ie,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[r.type==="text"&&r.header?a("div",{class:"content-header"},r.header):null,a("div",W(r))])])})])})):c.value.emptyResult)}});export{be as default};
